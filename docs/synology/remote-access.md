---
slug: synology-remote-access
keywords:
  - 黑群晖远程访问
  - 远程访问
  - ESXi黑群晖
  - DNET远程访问
  - 家庭All-in-One
  - ESXi环境搭建教程
  - 陈大剩的家庭AIO服务器
  - 家庭AIO服务器
  - QuickConnect
  - 群晖DDNS
description: 详细介绍在ESXi环境下安装黑群晖(DSM)的远程访问配置教程，包括QuickConnect、DDNS、内网穿透等多种远程访问方案的配置方法和最佳实践。
---

黑群晖安装完成后，远程访问是必不可少的功能，如果仅限于家中局域网使用，那就无法发挥 NAS 随时随地访问数据的优势。因为黑群晖 **无法使用群晖官方的 QuickConnect 服务**，所以需要远程访问方案。

## 远程访问方案对比
目前主流的远程访问方式包括：公网 IP 访问、内网穿透、CDN 中转、DDNS 动态域名解析等方案。

在选择远程访问方案前，建议先了解各方案的特点和适用场景：

| 方案类型 | 优势 | 劣势 | 适用场景 | 成本 |
|---------|------|------|---------|------|
| **公网 IPv4 直连** | 性能最佳、零延迟、配置简单 | 公网 IPv4 资源稀缺、IP 动态变化频繁、运营商获取困难 | 已获取公网 IPv4 地址 | 免费 |
| **公网 IPv6 直连** | 性能优秀、零延迟、地址充足 | IP 动态变化频繁、客户端 IPv6 支持率低、部分网络不可达 | 已获取公网 IPv6 地址 | 免费 |
| **DDNS 动态域名** | 解决动态 IP 问题、访问便捷 | 依赖公网 IP、DNS 解析存在传播延迟、域名续费管理 | 拥有公网 IP（IPv4/IPv6） | 免费（域名费用另计） |
| **DCDN 边缘加速** | 全球加速、双栈支持、高可用性、SSL 卸载 | 国内加速需备案、配置相对复杂、依赖第三方服务 | 拥有公网 IP + 需双栈访问 | 免费额度/按量计费 |
| **FRP 内网穿透** | 无公网 IP 要求、协议支持广泛、配置灵活 | 需中转服务器、存在转发延迟、服务器维护成本 | 无法获取公网 IP | 云服务器费用 |
| **VPN 隧道** | 安全性最高、全流量加密、网络透明 | 配置门槛高、移动端体验差、需持续连接 | 企业级安全需求 | 免费/云服务器费用 |

???- tip "方案选择建议"
    1. **优先级 1**：检查是否可以获取公网 IP（联系运营商）
    2. **优先级 2**：检查运营商是否支持 IPv6（推荐方案）
    3. **优先级 3**：使用 CDN 中转方案（如阿里云 ESA）
    4. **备选方案**：自建 FRP 内网穿透或购买商业穿透服务


## 远程访问实施方案
根据网络环境，选择以下合适的方案进行配置：
### 方案一：IP 直接访问

通过公网 IP 地址直接访问是最简单直接的远程访问方式。该方案尤其适合 IPv6 环境，因为无需中转服务器，访问速度快且延迟低。

???- info "方案特点"
    - **适用场景**：已获取公网 IPv4 或 IPv6 地址
    - **核心优势**：零延迟、速度快、配置简单
    - **主要缺点**：IP 地址动态变化频繁，需记忆或频繁查询
    
    IP 直接访问适合临时使用或配合 DDNS 方案。如果 IP 地址频繁变化，建议使用方案三或方案四。

#### 开启 IPv6 网络

如果已按照 [软路由 - 开启 IPv6](../route/ipv6.md) 章节配置好上游网络，还需要在群晖 DSM 中启用 IPv6 功能。

打开 **【控制面板】→【网络】→【网络界面】**，双击主网络接口进入编辑，在 **【IPv6】** 标签页中，选择 **【自动】** 配置方式，系统将自动从上游路由器获取 IPv6 地址。
![启用 IPv6](https://img.it927.com/aio/508.png)
配置完成后，确认群晖已成功获取公网 IPv6 地址

#### 访问测试

配置完成后，需要在不同设备（不连接 WiFi 的 IPv6 设备）上进行访问测试，验证远程访问功能是否正常。

=== "步骤 1：PC 端访问测试"
    在电脑浏览器中输入 `http://[IPv6地址]:5000` 访问 DSM

    **注意**：IPv6 地址需要用方括号包裹，例如：`http://[2001:db8::1]:5000`
    ![PC 端访问测试](https://img.it927.com/aio/509.png)

=== "步骤 2：移动端访问测试"
    在手机浏览器中同样输入 `http://[IPv6地址]:5000` 进行测试

    **要求**：移动设备必须连接支持 IPv6 的网络（4G/5G 或 IPv6 Wi-Fi）
    ![移动端访问测试](https://img.it927.com/aio/514.PNG)

???- warning "常见问题排查"
    如果无法访问，请依次检查：

    1. **防火墙设置**：检查路由器和群晖的防火墙是否阻止访问
    2. **IPv6 转发**：确认路由器已启用 IPv6 转发功能
    3. **网络环境**：确认客户端网络支持 IPv6 访问
    4. **端口检查**：使用在线工具测试端口 5000/5001 是否开放

#### DSM 安全设置（可选）

为了提升安全性，建议配置以下选项：

=== "配置 IP 检查策略"
    进入 **【控制面板】→【登录门户】→【高级】**，根据需求选择：

    - **默认（推荐）**：启用 IP 地址检查，安全性更高
    - **忽略检查**：仅在使用 CDN 或反向代理时启用

    对于 IP 直接访问，建议保持默认设置
    ![IP 检查设置](https://img.it927.com/aio/507.png)

???- info "关于 IP 地址检查"
    - **启用检查**：DSM 会验证请求来源 IP，防止会话劫持
    - **忽略检查**：允许来自任意 IP 的访问，适用于 CDN 中转场景
    - **建议**：IP 直接访问保持启用状态，CDN 方案才需要忽略

### 方案二：IPv6 + CDN 中转

如果需要同时支持 IPv4/IPv6 双协议栈访问，推荐使用 CDN 边缘加速方案。该方案通过 CDN 节点实现双栈协议转换，具有全球加速、高可用性等优势。

本节以腾讯云 [EdgeOne](https://console.cloud.tencent.com/edgeone) 提供的免费加速方案为例，使用 [D-NET](https://github.com/cxbdasheng/dnet) 开源工具实现 DCDN 功能的自动化配置。

???- tip "方案优势"
    - 支持 IPv4 和 IPv6 双协议栈访问
    - 免费额度充足（腾讯云 EdgeOne 免费版）
    - 全球 CDN 加速节点，访问速度快
    - 自动同步动态 IP 地址变化

#### 安装 Docker

群晖需要先安装 Container Manager（Docker）才能运行 D-NET 容器。

=== "步骤 1：安装 Container Manager"
    进入群晖 **【套件中心】**，搜索 `docker`，选择 **Container Manager** 并安装
    ![安装 Container Manager](https://img.it927.com/aio/487.png)

=== "步骤 2：配置 Docker 网络"
    在 Container Manager 中设置 Docker 网络子网，通常保持默认配置即可
    ![配置 Docker 网络](https://img.it927.com/aio/488.png)

=== "步骤 3：确认配置"
    检查 Docker 配置信息，确认无误后点击 **【完成】**
    ![检查 Docker 配置](https://img.it927.com/aio/489.png)

=== "步骤 4：验证安装"
    安装完成后，可在 **【套件中心】** 查看到 Container Manager
    ![完成 Docker 安装](https://img.it927.com/aio/490.png)

#### 安装 D-NET

[D-NET](https://github.com/cxbdasheng/dnet) 是一款轻量级动态网络管理工具，支持多平台的 CDN、DNS 和内网穿透自动化管理与监控。

=== "步骤 1：搜索 D-NET 镜像"
    进入 **【套件中心】→【Container Manager】→【镜像仓库】**，搜索 `dnet`，点击选择
    ![搜索 D-NET 镜像](https://img.it927.com/aio/491.png)

=== "步骤 2：下载镜像"
    选择最新版本（通常默认为 `latest` 标签），点击 **【下载】**
    ![下载 D-NET 镜像](https://img.it927.com/aio/492.png)

=== "步骤 3：创建容器"
    进入 **【Container Manager】→【容器】**，点击 **【新增】**
    ![创建 Docker 容器](https://img.it927.com/aio/493.png)

=== "步骤 4：常规设置"
    - **映像**：选择 `dnet`
    - **容器名称**：自定义（如 `dnet`）
    - **启用自动重新启动**：勾选此选项，确保容器随系统启动
    ![Docker 常规设置](https://img.it927.com/aio/494.png)

=== "步骤 5：端口和存储设置"
    - **端口映射**：保持默认（端口 9877）
    - **存储空间映射**：挂载到容器内的 `/root` 目录
    ![Docker 端口存储设置](https://img.it927.com/aio/495.png)

=== "步骤 6：网络设置（重要）"
    网络模式必须设置为 **【host】** 模式，以便 D-NET 能够正确检测宿主机的 IPv6 地址
    ![Docker 网络设置](https://img.it927.com/aio/496.png)

=== "步骤 7：确认创建"
    检查所有配置参数，确认无误后点击 **【完成】**
    ![确认创建容器](https://img.it927.com/aio/497.png)

!!! warning "网络模式说明"
    D-NET 容器必须使用 `host` 网络模式，否则无法正确获取宿主机的动态 IPv6 地址。

#### 配置腾讯云 EdgeOne

本节以腾讯云 [EdgeOne](https://console.cloud.tencent.com/edgeone) 为例，其他 CDN 方案请参考 [阿里云 ESA 免费加速方案](../remote/esa.md)。

=== "步骤 1：新增站点"
    登录 [EdgeOne 控制台](https://console.cloud.tencent.com/edgeone)，选择 **【服务总览】→【新增站点】**
    ![新增站点](https://img.it927.com/aio/499.png)

=== "步骤 2：选择套餐"
    选择免费版套餐。如未领取，请访问 [免费版套餐使用说明](https://cloud.tencent.com/document/product/1552/118985) 申请
    ![选择套餐](https://img.it927.com/aio/500.png)

=== "步骤 3：等待配置下发"
    套餐配置需要几秒钟时间下发，请耐心等待
    ![等待配置下发](https://img.it927.com/aio/501.png)

=== "步骤 4：配置接入模式"
    - **服务区域**：已备案域名可选择全球（含中国大陆）
    - **接入方式**：建议选择 **CNAME** 接入，无需托管 DNS 解析
    ![配置接入模式](https://img.it927.com/aio/502.png)

=== "步骤 5：域名归属验证"
    首次添加域名需要验证域名所有权，按照提示添加 TXT 记录完成验证
    ![域名归属验证](https://img.it927.com/aio/503.png)

???- info "接入方式选择"
    - **CNAME 接入**：推荐方式，保持现有 DNS 服务商不变
    - **NS 接入**：需要修改域名 NS 记录，将 DNS 托管到腾讯云

#### 配置 D-NET

D-NET 安装完成后，通过浏览器访问 `http://群晖IP:9877` 进入 Web 管理界面。

![D-NET 登录界面](https://img.it927.com/aio/498.png)

首次访问需要设置管理员账号和密码，完成后按以下步骤配置：

=== "步骤 1：配置 DCDN 参数"
    1. 启用 **DCDN** 功能开关
    2. 填写腾讯云 **SecretId** 和 **SecretKey**（在腾讯云访问管理中获取）
    3. 配置源站信息（域名、端口等）
    ![配置 DCDN 参数](https://img.it927.com/aio/504.png)

=== "步骤 2：获取 CNAME 记录"
    点击保存后，D-NET 将自动监听 IPv6 地址变化并同步到 EdgeOne。系统会生成 CNAME 地址，点击复制按钮
    ![获取 CNAME 记录](https://img.it927.com/aio/505.png)

=== "步骤 3：添加 DNS 解析"
    在域名 DNS 服务商处添加 CNAME 记录，将子域名指向上一步获取的 CNAME 地址
    ![添加 DNS 解析](https://img.it927.com/aio/506.png)

!!! tip "如何获取腾讯云密钥"
    访问 [腾讯云访问管理](https://console.cloud.tencent.com/cam/capi) 创建 SecretId 和 SecretKey。建议创建子账号并授予 EdgeOne 相关权限，避免使用主账号密钥。

#### 群晖 DSM 设置

为确保 CDN 中转正常工作，DSM 系统需要配置以下选项：

=== "步骤 1：配置反向代理信任"
    进入 **【控制面板】→【登录门户】→【高级】**，启用 **【忽略 IP 地址检查】**

    此选项允许通过 CDN 代理访问 DSM，否则会因 IP 不匹配而拒绝连接
    ![忽略 IP 检查](https://img.it927.com/aio/507.png)

=== "步骤 2：设置主机名称"
    进入 **【控制面板】→【网络】→【常规】**，配置 **【服务器名称】** 为你的访问域名

    此设置确保 DSM 能正确响应来自 CDN 的请求
    ![设置主机名称](https://img.it927.com/aio/511.png)

!!! warning "安全提示"
    启用"忽略 IP 地址检查"会降低一定的安全性，建议配合防火墙规则、双因素认证等安全措施使用。

#### 测试验证
配置完成后，通过浏览器访问配置的域名，验证是否能正常访问服务。
示例：访问 `http://nas.it927.com`，页面正常加载即表示配置成功。
![访问测试](https://img.it927.com/aio/512.png)
#### 性能测试
通过全球节点延迟测试，验证 EdgeOne 加速效果：
![全球节点延迟测试](https://img.it927.com/aio/513.png)
### 方案三：IPv6 + DDNS
如果你的运营商支持 IPv6，这是最佳的免费远程访问方案，缺点是 IPv6 支持率低、部分网络不可达。

**配置指南**：请参考 [远程访问 - IPv6 DDNS](../remote/ipv6.md) 章节的详细教程。

### 方案四：公网 IP + DDNS

如果成功获取了公网 IP，这是性能最佳的方案。

**配置指南**：请参考 [远程访问 - 公网 NAT](../remote/nat.md) 章节的详细教程。

### 方案五：FRP 内网穿透

如果无法获取公网 IP 且不想使用 IPv6，可以选择 FRP 内网穿透。

**配置指南**：请参考 [远程访问 - FRP 内网穿透](../remote/frp.md) 章节的详细教程。

## 群晖远程访问安全设置

配置远程访问后，安全设置至关重要，以下是推荐的安全配置：

### 启用 HTTPS 访问

使用 HTTPS 可以加密传输数据，防止中间人攻击。

=== "步骤 1：申请 SSL 证书"
    有以下几种方式获取 SSL 证书：

    - **Let's Encrypt**：免费，群晖支持自动续期
    - **阿里云/腾讯云**：免费证书（1年有效期）
    - **Cloudflare**：15年免费证书

    详细配置请参考：[群晖 SSL 证书配置](ssl.md)

=== "步骤 2：导入证书"
    在 **【控制面板】-【安全性】-【证书】** 中导入或创建证书

=== "步骤 3：强制 HTTPS"
    在 **【控制面板】-【网络】-【DSM 设置】** 中：

    - 勾选 **【自动将 HTTP 连接重定向到 HTTPS】**
    - 勾选 **【启用 HSTS】**（增强安全性）

