---
slug: disk-partitioning
keywords: 
  - 硬盘划分
  - 家庭AIO硬盘划分
  - 家庭AIO搭建教程
  - 家庭All-in-One搭建教程
description: 由于需要多开虚拟机使用，如果几十个虚拟机同时运行的话，对硬盘的负担也是不小的，所以选择如下的方案
---
在构建家庭 All-in-One 服务器时，合理规划硬盘资源对于性能和稳定性至关重要。尤其是当多个虚拟机同时运行时，硬盘的读写压力会显著增加，不能将所有的压力放到一个盘中。为此，陈大剩制定了如下硬盘分配方案：

| 硬盘           | 型号                            | 插槽      | 速率         | 用途                            |
| -------------- | ------------------------------- | --------- | ------------ | ------------------------------- |
| **NVME-SSD-1** | 西数 SN570 NVEM 协议 SSD 1TB    | M.2 插槽  | PCIe 3.0 × 4 | 存放运行虚拟机                  |
| **NVME-SSD-2** | 西数 SN770 NVEM 协议 SSD 500 GB | M.2 插槽  | PCIe 3.0 × 4 | 直通给黑苹果（或其他操作系统）  |
| **NVME-SSD-3** | 三星 980 NVEM 协议 SSD 512 GB   | M.2 插槽  | PCIe 2.0 × 4 | **ESXi 系统盘（镜像）**             |
| **NVME-SSD-4** | 小海豚 6536 3.2T AIC 刀卡       | PCIe 插槽 | PCIe 3.0 × 4 | 存放运行虚拟机                  |
| **NVME-SSD-5** | 未知固态硬盘（购买的路上）       | PCIe 插槽 | PCIe 3.0 × 4 | 虚拟机不够时拓展                |
| **HDD-1**      | 希捷 ST2000VX008 4TB            | SATA 接口 | SATA 3.0     | 直通给黑群晖（存储池1）         |
| **HDD-2**      | 西数   1TB                      | SATA 接口 | SATA 3.0     | 直通给黑群晖（存储池2）         |
| **HDD-3**      | 未知硬盘 4TB（购买的路上）      | SATA 接口 | SATA 3.0     | 直通给黑群晖（给存储池1做备份） |

![硬盘槽位图](https://img.it927.com/aio/25.png)


## 设计思路

### 系统盘

前面也多次说过，因为主板的第三个 M.2 接口只有 PCIe 2.0 × 4 速率，所以 **NVME-SSD-3** 接口上的硬盘用于安装 ESXi 操作系统。该硬盘 **适合安装对读写要求不高的系统**，如：软路由、DNS 服务器 、广告过滤器等，同时可以作为系统镜像盘，存储这些操作系统的镜像文件。

### 直通盘

细心的网友肯定会发现，陈大剩的 **NVME-SSD-2** 是 PCIe 4.0 × 4 速率的硬盘，这块虽然是PCIe 4.0 × 4 但插在 PCIe 3.0 × 4 插槽上，速率任然只有 PCIe 3.0 × 4 的速度。这块硬盘打算用来直通某个操作系统，以达到最优的速度，比如 黑苹果 或 W10 。

这样设计的优势：

1. 后续有转移操作系统需求时，可直接更换硬盘；
2. 即使整个 AIO 系统崩溃，只要硬盘完好，资源仍可继续使用；

### 公共盘 NAS 存储

考虑到内网已升级至 2.5 Gbps 网络环境，我本算 3.2TB 的 NVMe 固态硬盘直通给黑群晖做 **SSD 存储池**，但发现 **SSD 存储池** 2.5G 压根就跑不满，后续升级至万兆网络环境可以考虑用 **SSD 存储池** 方案。因此采用以下方案：

- <del>**SSD 存储池**：选用一块 3.2TB 的 NVMe 固态硬盘直通给黑群晖，用于高速读写任务（如迅雷下载、视频缓存等），充分发挥 2.5G 网络带宽优势。</del>
- **HDD 存储池1**：配备一块或多块大容量机械硬盘（如 4TB），用来存储私有化的关键数据，如影音、文件、重要资源；
- **HDD 存储池2**： 1TB 机械存储池，用于存储一些公共服务相关数据，可以对外提供展示，如 WEB 服务资源等；
- **冗余备份机制**：未来计划引入第三块硬盘作为关键数据备份，进一步保障数据安全；

**HDD 存储池1** 和 **HDD 存储池2** 主要是考虑敏感数据问题，其次可以将公共盘 NAS 存储以虚拟盘的形式分给各个 AIO 中的操作系统，这样设计不仅能满足当前家庭 NAS 的性能需求，也为后续升级至万兆网络环境打下良好基础。

### 虚拟机系统盘

这个盘就没有太多要讲的了，主要用于分给各个操作系统做系统盘，然后通过上面的公共盘 NAS 存储虚拟盘做数据共享，主要的硬盘是 **NVME-SSD-1** 和 **NVME-SSD-4** ，这两个盘基本能满足多个虚拟机同时运行了，后续不够可以考虑再添加。








